<% if crumbs.present? %>
  <nav aria-label="Fil d'ariane" class="mb-6" data-controller="breadcrumbs">
    <!-- Version desktop : chemin complet -->
    <div class="hidden md:flex items-center flex-wrap gap-2 text-sm text-gray-500">
      <% crumbs.each_with_index do |crumb, index| %>
        <% if index > 0 %>
          <i class="fas fa-chevron-right text-xs text-gray-400 mx-1" aria-hidden="true"></i>
        <% end %>

        <% if index == 0 && crumb[:is_home] && crumb[:path].present? %>
          <%= link_to crumb[:path],
              class: "inline-flex items-center gap-1 text-gray-500 font-medium hover:text-secondary transition-colors",
              title: crumb[:name],
              "aria-label": crumb[:name],
              data: { breadcrumbs_target: "link" } do %>
            <i class="fas fa-home" aria-hidden="true"></i>
            <span><%= crumb[:name] %></span>
          <% end %>
        <% elsif crumb[:path].present? %>
          <%= link_to crumb[:name], crumb[:path],
              class: "text-gray-500 font-medium hover:text-secondary transition-colors",
              title: crumb[:name],
              data: { breadcrumbs_target: "link" } %>
        <% else %>
          <span class="text-secondary font-semibold" title="<%= crumb[:name] %>" aria-current="page">
            <%= crumb[:name] %>
          </span>
        <% end %>
      <% end %>
    </div>

    <!-- Structured Data pour SEO -->
    <script type="application/ld+json">
      <%= breadcrumbs_structured_data(crumbs, request.original_url) %>
    </script>

    <!-- Version mobile : retour au parent uniquement -->
    <% if crumbs.length > 1 %>
      <% parent = crumbs[-2] %>
      <% if parent && parent[:path].present? %>
        <div class="md:hidden">
          <%= link_to parent[:path], class: "inline-flex items-center gap-2 text-sm text-gray-500 font-medium hover:text-secondary transition-colors" do %>
            <i class="fas fa-arrow-left" aria-hidden="true"></i>
            <span><%= parent[:name] %></span>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </nav>
<% end %>
